{"ast":null,"code":"var _jsxFileName = \"/home/soni/project/src/body.js\";\nimport React, { useState, useEffect } from 'react';\nimport ImageModal from './ImageModal';\nimport _ from 'lodash';\nimport './body.css';\n\nconst getData = async (search, page) => {\n  let data = [];\n  const url = `https://www.flickr.com/services/rest/?method=flickr.photos.search&per_page=25&api_key=506e716ab594396861cd8e374cf41d89&text=${search}&page=${page}&format=json&nojsoncallback=1`;\n  await fetch(url).then(response => response.json()).then(value => {\n    if ('photos' in value) {\n      data = value.photos.photo;\n    }\n  });\n  return data;\n};\n\nvar debouneGetData, throatleGetData;\n\nfunction Body(props) {\n  const [open, setOpen] = useState(false);\n  const [modal, setModal] = useState({});\n  const [data, setData] = useState([]);\n  const [page, setPage] = useState(1);\n  useEffect(() => {\n    debouneGetData = _.debounce(handleData, 2000);\n    throatleGetData = _.throttle(handleData, 2000);\n    window.addEventListener(\"scroll\", handleScroll, false);\n    console.log(typeof debouneGetData);\n    return () => window.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n\n  const handleData = async (mode, ...args) => {\n    let dataSet = await getData(...args);\n\n    if (mode == 'page') {\n      setData(data => [...data, ...dataSet]);\n    } else {\n      window.scrollTo(0, 0);\n      setData(dataSet);\n      setPage(1);\n    }\n  };\n\n  useEffect(() => {\n    debouneGetData('query', props.query, page);\n    console.log('changes');\n  }, [props.query]);\n  useEffect(() => {\n    throatleGetData('page', props.query, page);\n    console.log('changes');\n  }, [page]);\n\n  const handleScroll = () => {\n    let element = document.getElementById('photos');\n    console.log(window.scrollY, window.innerHeight, element.clientHeight, element.offsetTop);\n\n    if (window.scrollY + window.innerHeight > element.clientHeight + element.offsetTop) {\n      setPage(page => page + 1);\n    }\n  };\n\n  const handleClick = (url, title) => {\n    setOpen(true);\n    setModal({\n      url: url,\n      title: title\n    });\n  };\n\n  return React.createElement(\"div\", {\n    className: \"photos\",\n    id: \"photos\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, data.map(val => {\n    let url = `https://farm${val.farm}.staticflickr.com/${val.server}/${val.id}_${val.secret}.jpg`;\n    return React.createElement(\"img\", {\n      src: url,\n      className: \"list_image\",\n      key: val.id,\n      onClick: () => handleClick(url, val.title),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    });\n  }), React.createElement(ImageModal, {\n    image: modal,\n    open: open,\n    setOpen: setOpen,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }));\n}\n\nexport default Body;","map":{"version":3,"sources":["/home/soni/project/src/body.js"],"names":["React","useState","useEffect","ImageModal","_","getData","search","page","data","url","fetch","then","response","json","value","photos","photo","debouneGetData","throatleGetData","Body","props","open","setOpen","modal","setModal","setData","setPage","debounce","handleData","throttle","window","addEventListener","handleScroll","console","log","removeEventListener","mode","args","dataSet","scrollTo","query","element","document","getElementById","scrollY","innerHeight","clientHeight","offsetTop","handleClick","title","map","val","farm","server","id","secret"],"mappings":"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","sourcesContent":["import React,{useState, useEffect} from 'react';\nimport ImageModal from './ImageModal'\nimport _ from 'lodash';\nimport './body.css';\n\n\nconst getData = async (search,page) => {\n  let data = [];\n  const url = `https://www.flickr.com/services/rest/?method=flickr.photos.search&per_page=25&api_key=506e716ab594396861cd8e374cf41d89&text=${search}&page=${page}&format=json&nojsoncallback=1`;\n  await fetch(url)\n  .then((response) => response.json())\n  .then(value => {\n    if('photos' in value) {\n      data = value.photos.photo;\n    }\n  })\n  return data;\n}\nvar debouneGetData,throatleGetData;\n\nfunction Body(props) {\n    const [open,setOpen] = useState(false);\n    const [modal,setModal] = useState({});\n    const [data,setData] = useState([]);\n    const [page,setPage] = useState(1);\n\n    useEffect(() => {\n      debouneGetData = _.debounce(handleData,2000);\n      throatleGetData = _.throttle(handleData,2000);\n      window.addEventListener(\"scroll\", handleScroll, false)\n      console.log(typeof(debouneGetData))\n      return (()=> window.removeEventListener(\"scroll\",handleScroll));\n    },[]);\n\n    const handleData  = async (mode,...args) => {\n      let dataSet = await getData(...args);\n      if(mode == 'page') {\n        setData(data => [...data,...dataSet]);\n      } else {\n        window.scrollTo(0,0)\n        setData(dataSet);\n        setPage(1);\n      }\n    }\n\n    useEffect( () => {\n      \n      debouneGetData('query',props.query,page);\n      console.log('changes')\n    },[props.query])\n\n    useEffect( () => {\n      throatleGetData('page',props.query,page);\n      console.log('changes')\n    },[page])\n      \n    const handleScroll = () => {\n      let element = document.getElementById('photos');\n      console.log(window.scrollY, window.innerHeight, element.clientHeight, element.offsetTop)\n      if (window.scrollY + window.innerHeight > element.clientHeight + element.offsetTop) {\n        setPage( page => page + 1 );\n      }\n    }\n\n    const handleClick = (url,title) => {\n      setOpen(true);\n      setModal({url:url,title:title})\n    }\n    \n\n\n  return (\n      <div className=\"photos\" id='photos'  >      \n        {data.map(val => {\n            let url = `https://farm${val.farm}.staticflickr.com/${val.server}/${val.id}_${val.secret}.jpg`;\n            return(\n            <img src={url} className=\"list_image\" key={val.id} onClick={() => handleClick(url,val.title)}/>\n        )})}\n      <ImageModal image={modal} open={open} setOpen={setOpen}/>\n  </div>\n  );\n}\n\nexport default Body;\n"]},"metadata":{},"sourceType":"module"}