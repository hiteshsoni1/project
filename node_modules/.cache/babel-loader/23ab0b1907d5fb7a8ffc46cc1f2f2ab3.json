{"ast":null,"code":"var _jsxFileName = \"/home/soni/project/src/body.js\";\nimport React, { useState, useEffect } from 'react';\nimport ImageModal from './ImageModal';\nimport _ from 'lodash';\nimport './body.css';\n\nconst handleClick = (setOpen, url, title, setModal) => {\n  setOpen(true);\n  setModal({\n    url: url,\n    title: title\n  });\n};\n\nvar debouneGetData;\n\nfunction Body(props) {\n  const [open, setOpen] = useState(false);\n  const [modal, setModal] = useState({});\n  const [data, setData] = useState([]);\n  const [page, setPage] = useState(1);\n  useEffect(() => {\n    debouneGetData = _.debounce(getData, 2000);\n    window.addEventListener(\"scroll\", handleScroll, false);\n    console.log('listner', page);\n    return () => {\n      console.log('we unmount');\n    };\n    window.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n  useEffect(() => {\n    debouneGetData(props.query, setData, data, page);\n    console.log('changes');\n  }, [props.query, page]);\n\n  const handleScroll = () => {\n    let element = document.getElementById('photos');\n    console.log(window.scrollY, window.innerHeight, element.clientHeight, element.offsetTop);\n\n    if (window.scrollY + window.innerHeight > element.clientHeight + element.offsetTop) {\n      setPage(page => page + 1);\n      console.log('scroll', data);\n    }\n  };\n\n  const handleClick = (url, title, setModal) => {\n    setOpen(true);\n    setModal({\n      url: url,\n      title: title\n    });\n  };\n\n  const getData = (search, setData, data, page) => {\n    const url = `https://www.flickr.com/services/rest/?method=flickr.photos.search&per_page=25&api_key=506e716ab594396861cd8e374cf41d89&text=${search}&page=${page}&format=json&nojsoncallback=1`;\n    fetch(url).then(response => response.json()).then(value => {\n      if ('photos' in value) {\n        setData([...data, ...value.photos.photo]);\n        console.log(url, page);\n      }\n    });\n    console.log(search);\n  };\n\n  return React.createElement(\"div\", {\n    className: \"photos\",\n    id: \"photos\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, data.map(val => {\n    let url = `https://farm${val.farm}.staticflickr.com/${val.server}/${val.id}_${val.secret}.jpg`;\n    return React.createElement(\"img\", {\n      src: url,\n      className: \"list_image\",\n      key: val.id,\n      onClick: () => handleClick(url, val.title),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    });\n  }), React.createElement(ImageModal, {\n    image: modal,\n    open: open,\n    setOpen: setOpen,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }));\n}\n\nexport default Body; // const useStyles = makeStyles({\n//   root: {\n//       position: 'fixed',\n//       alignSelf:'center',\n//       top: '20%',\n//       left: '30%',\n//   },\n// });","map":{"version":3,"sources":["/home/soni/project/src/body.js"],"names":["React","useState","useEffect","ImageModal","_","handleClick","setOpen","url","title","setModal","debouneGetData","Body","props","open","modal","data","setData","page","setPage","debounce","getData","window","addEventListener","handleScroll","console","log","removeEventListener","query","element","document","getElementById","scrollY","innerHeight","clientHeight","offsetTop","search","fetch","then","response","json","value","photos","photo","map","val","farm","server","id","secret"],"mappings":"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","sourcesContent":["import React,{useState, useEffect} from 'react';\nimport ImageModal from './ImageModal'\nimport _ from 'lodash';\nimport './body.css';\n\nconst handleClick = (setOpen,url,title,setModal) => {\n    setOpen(true);\n    setModal({url:url,title:title})\n}\n\n\n\nvar debouneGetData;\n\n\nfunction Body(props) {\n    const [open,setOpen] = useState(false);\n    const [modal,setModal] = useState({});\n    const [data,setData] = useState([]);\n    const [page,setPage] = useState(1);\n\n    useEffect(() => {\n      debouneGetData = _.debounce(getData,2000);\n      window.addEventListener(\"scroll\", handleScroll, false)\n      console.log('listner',page)\n      return (()=> {console.log('we unmount')});\n        window.removeEventListener(\"scroll\",handleScroll);\n    },[]);\n\n    useEffect(() => {\n      debouneGetData(props.query,setData,data,page);\n      console.log('changes')\n    },[props.query,page])\n\n      \n    const handleScroll = () => {\n      let element = document.getElementById('photos');\n      console.log(window.scrollY, window.innerHeight, element.clientHeight, element.offsetTop)\n      if (window.scrollY + window.innerHeight > element.clientHeight + element.offsetTop) {\n        setPage( page => page + 1 );\n        console.log('scroll',data);\n      }\n    }\n\n    const handleClick = (url,title,setModal) => {\n      setOpen(true);\n      setModal({url:url,title:title})\n  }\n    \n  const getData = (search,setData,data,page) => {\n    const url = `https://www.flickr.com/services/rest/?method=flickr.photos.search&per_page=25&api_key=506e716ab594396861cd8e374cf41d89&text=${search}&page=${page}&format=json&nojsoncallback=1`;\n    fetch(url)\n    .then((response) => response.json())\n    .then(value => {\n      if('photos' in value) {\n      setData([...data,...value.photos.photo])\n        console.log(url,page);\n    }\n    })\n    console.log(search);\n  }\n\n  return (\n      <div className=\"photos\" id='photos'  >      \n        {data.map(val => {\n            let url = `https://farm${val.farm}.staticflickr.com/${val.server}/${val.id}_${val.secret}.jpg`;\n            return(\n            <img src={url} className=\"list_image\" key={val.id} onClick={() => handleClick(url,val.title)}/>\n        )})}\n      <ImageModal image={modal} open={open} setOpen={setOpen}/>\n  </div>\n  );\n}\n\nexport default Body;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// const useStyles = makeStyles({\n//   root: {\n//       position: 'fixed',\n//       alignSelf:'center',\n//       top: '20%',\n//       left: '30%',\n//   },\n// });\n"]},"metadata":{},"sourceType":"module"}